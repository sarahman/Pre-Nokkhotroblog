<?php
/**
 * Episod Controller
 *
 * @Group Type   Controller
 * @package     Blog
 * @author      Md. Sirajus Salayhin <salayhin@gmail.com>
 */
class Blog_DeftController extends Speed_Controller_ActionController
{

    public function indexAction()
    {   
        //$this->_helper->layout->setLayout('general');
        $episodnameModel = new Blog_Model_EpisodName();
        $display = $episodnameModel->getAll();
        $this->view->display = $display;
    }
    


    
    public function editDraftAction()
    {
        $this->_helper->layout->setLayout('userprofile');
        $this->validateUser();
        $draftId = $this->_request->getParam('id');
        $episodModel = new Blog_Model_Episod();
        
       //$episodModel->getDetail();
       $blogstatus= new Blog_Model_BlogStatus();
        $options = array(
            'isEdit'   => true,
            'status' => $blogstatus->getSelected()
        );
       $episodEntry = new Blog_Form_EpisodEntry($options); 
     
        if ($this->_request->isPost()) {
             $data = $this->_request->getParams();
      var_dump($data);die; 
            if ($episodEntry->isValid($data)) {
                $result = $episodModel->modify($data, $draftId);
                if (empty($result)) {
                    $this->redirectForFailure('/blog/episods/display-draft', 'Problem , Please try again.');
                } else {
                    $this->redirectForSuccess('/blog/episods/display-draft', 'Draft has updated successfully.');
                }
            } else {
                $episodEntry->populate($data);
            }
        } else {

            if (empty($draftId)) {
                $this->redirectForFailure('/blog/episods/display-draft', 'No drafts found');
            } else {
               $episodModel =new Blog_Model_Episod();
                $episodData = $episodModel->getDetail($draftId);
                if (empty($episodData)) {
                    $this->redirectForFailure('/blog/episods/', 'No Episod found.');
                } else {
                    $episodEntry->populate($episodData);
                }
            }
        }
        $this->view->DraftForm = $episodEntry;
    }
    








    
  

    
 

    


}

